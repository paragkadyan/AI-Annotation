# VS Code Extension Test Suite

## Environment Configuration
- **empid**: 1223
- **Test Date**: 2025-02-15
- **Extension Status**: Installed

---

## Test 1: Extension Activation

**Objective**: Verify the extension loads and activates

**Steps**:
1. Open VS Code
2. Open the Command Palette (Ctrl+Shift+P)
3. Type: `Developer: Show Extension Details`
4. Search for: `ai-code-annotator`
5. Verify status shows: **Active**

**Expected Result**: ✅ Extension appears in list and is active

**Configuration to Add to settings.json**:
```json
{
  "ai-annotator.authorId": "emp-1223",
  "ai-annotator.defaultTool": "GitHub Copilot"
}
```

---

## Test 2: Keyboard Shortcut

**Objective**: Verify Ctrl+Shift+A (Windows/Linux) or Cmd+Shift+A (Mac) activates the annotation

**Steps**:
1. Create a new file in VS Code
2. Set language to Python:
   - Press Ctrl+K, M (Windows/Linux) or Cmd+K, M (Mac)
   - Type: `Python`
3. Paste this code:
```python
def hello_world():
    return "Hello, World!"
```

4. Select all code (Ctrl+A)
5. Press keyboard shortcut:
   - **Windows/Linux**: Ctrl+Shift+A
   - **Mac**: Cmd+Shift+A

**Expected Result**:
- ✅ Dialog appears: "Was this code generated using AI?"
- ✅ Options: Yes / No / (Cancel)

---

## Test 3: AI Confirmation Dialog

**Steps** (continue from Test 2):
1. Dialog shows: "Was this code generated using AI?"
2. Click: **Yes**

**Expected Result**: ✅ Next dialog appears asking for Tool Name

---

## Test 4: Metadata Collection - Tool Name

**Steps**:
1. Dialog shows: "AI Tool Name:"
2. Placeholder: "e.g., GitHub Copilot, GPT-4, Claude"
3. Type: `GitHub Copilot`
4. Press Enter

**Expected Result**: ✅ Next dialog appears for Tool Version

---

## Test 5: Metadata Collection - Tool Version

**Steps**:
1. Dialog shows: "AI Tool Version (optional):"
2. Type: `1.0.5` (or leave blank)
3. Press Enter

**Expected Result**: ✅ Next dialog appears for Author ID

---

## Test 6: Metadata Collection - Author ID

**Steps**:
1. Dialog shows: "Developer ID/Author ID:"
2. Placeholder: "e.g., dev-001, john.doe"
3. Type: `emp-1223`
4. Press Enter

**Expected Result**: ✅ Confirmation dialog appears

---

## Test 7: Final Confirmation

**Steps**:
1. Dialog shows: "Annotate as generated by GitHub Copilot (emp-1223)?"
2. Click: **Yes**

**Expected Result**: ✅ Code is wrapped with annotations

**Verify Output Should Be**:
```python
# START_AI_GENERATED_CODE
# TOOL_NAME: GitHub Copilot
# TOOL_VERSION: 1.0.5
# DATE: 2025-02-15T14:30:00Z
# AUTHOR_ID: emp-1223
# ACTION: GENERATED
def hello_world():
    return "Hello, World!"
# END_AI_GENERATED_CODE
```

---

## Test 8: Automatic Detection (Paste Test)

**Objective**: Extension detects pasted multi-line code

**Steps**:
1. Open a new Python file
2. Copy this JavaScript code (to simulate pasted code):
```javascript
function fibonacci(n) {
    if (n <= 1) return n;
    return fibonacci(n-1) + fibonacci(n-2);
}
```

3. Paste it into the Python file (Ctrl+V)
4. Wait ~1 second for debounce

**Expected Result**: ✅ Dialog appears: "Was this code generated using AI?"

---

## Test 9: Decline Annotation

**Steps** (continue from Test 8):
1. Dialog shows: "Was this code generated using AI?"
2. Click: **No**

**Expected Result**: ✅ Dialog closes, code remains unwrapped

---

## Test 10: Manual Command

**Objective**: Test using Command Palette instead of shortcut

**Steps**:
1. Open a new file and add code:
```javascript
const greet = (name) => `Hello, ${name}!`;
```

2. Select the code (Ctrl+A)
3. Open Command Palette (Ctrl+Shift+P)
4. Type: `Mark Selected Code as AI-Generated`
5. Press Enter

**Expected Result**: ✅ Metadata dialogs appear (same as Test 4-6)

---

## Test 11: Language Support - JavaScript

**Objective**: Verify JavaScript uses correct comment syntax (`//`)

**Steps**:
1. Create a new JavaScript file
2. Add code:
```javascript
const add = (a, b) => a + b;
```

3. Select code
4. Press Ctrl+Shift+A
5. Provide metadata
6. Confirm

**Expected Output** (should use `//` not `#`):
```javascript
// START_AI_GENERATED_CODE
// TOOL_NAME: GPT-4
// DATE: 2025-02-15T14:35:00Z
// AUTHOR_ID: emp-1223
// ACTION: GENERATED
const add = (a, b) => a + b;
// END_AI_GENERATED_CODE
```

**Expected Result**: ✅ JavaScript uses `//` comments

---

## Test 12: Language Support - SQL

**Objective**: Verify SQL uses correct comment syntax (`--`)

**Steps**:
1. Create a new SQL file (save as `.sql`)
2. Add code:
```sql
SELECT id, name FROM users WHERE active = 1;
```

3. Select code
4. Press Ctrl+Shift+A
5. Provide metadata
6. Confirm

**Expected Output** (should use `--` not `#` or `//`):
```sql
-- START_AI_GENERATED_CODE
-- TOOL_NAME: Claude
-- DATE: 2025-02-15T14:40:00Z
-- AUTHOR_ID: emp-1223
-- ACTION: GENERATED
SELECT id, name FROM users WHERE active = 1;
-- END_AI_GENERATED_CODE
```

**Expected Result**: ✅ SQL uses `--` comments

---

## Test 13: Indentation Preservation

**Objective**: Verify code indentation is preserved

**Steps**:
1. Create a new Python file
2. Add indented code:
```python
class MyClass:
    def method(self):
        return "test"
```

3. Select just the `method` code (indented part)
4. Press Ctrl+Shift+A
5. Provide metadata
6. Confirm

**Expected Output** (indentation preserved):
```python
    # START_AI_GENERATED_CODE
    # TOOL_NAME: ...
    # ...
    def method(self):
        return "test"
    # END_AI_GENERATED_CODE
```

**Expected Result**: ✅ Indentation is preserved

---

## Test 14: Settings Persistence

**Objective**: Verify VS Code settings are respected

**Steps**:
1. Ensure settings are configured:
```json
{
  "ai-annotator.authorId": "emp-1223",
  "ai-annotator.defaultTool": "GitHub Copilot"
}
```

2. Create new file and code
3. Press Ctrl+Shift+A
4. First dialog should show Tool Name field with:
   - **Value**: "GitHub Copilot" (from defaultTool)
5. Skip to Author ID dialog
6. Should show:
   - **Value**: "emp-1223" (from authorId)

**Expected Result**: ✅ Settings pre-fill the defaults

---

## Test 15: Error Handling - Empty Selection

**Objective**: Verify error when no code selected

**Steps**:
1. Open a file
2. Click somewhere (deselect any text)
3. Press Ctrl+Shift+A

**Expected Result**:
- ✅ Error message appears
- ✅ Message: "No code selected. Please select code to annotate."

---

## Test 16: Error Handling - Unsupported Language

**Objective**: Verify error for unsupported languages

**Steps**:
1. Create a new file with unsupported language (e.g., `.xyz`)
2. Add some code
3. Select code
4. Press Ctrl+Shift+A

**Expected Result**:
- ✅ Error message appears
- ✅ Message contains: "not currently supported"

---

## Test 17: Integration with Validator

**Objective**: Verify annotated code passes validator

**Steps**:
1. Create annotations using extension (Test 2-7)
2. Save the file
3. Open terminal
4. Run validator:
```bash
python -c "
import sys
sys.path.insert(0, 'src/python-validator/src')
from pathlib import Path
from ai_code_validator.parser import AnnotationParser

parser = AnnotationParser()
file_path = Path('<your_file.py>')
content = file_path.read_text()
blocks, errors = parser.validate_file(file_path, content)

print(f'Validation: {\"PASS\" if len(errors) == 0 else \"FAIL\"}')
print(f'Blocks found: {len(blocks)}')
print(f'Errors: {len(errors)}')
"
```

**Expected Result**: ✅ PASS - 1 block, 0 errors

---

## Quick Test Summary

| Test # | Feature | Expected | Status |
|--------|---------|----------|--------|
| 1 | Extension Activation | Active | [ ] |
| 2 | Keyboard Shortcut | Dialog | [ ] |
| 3 | AI Confirmation | Yes/No | [ ] |
| 4 | Tool Name Input | Dialog | [ ] |
| 5 | Version Input | Dialog | [ ] |
| 6 | Author ID Input | Dialog | [ ] |
| 7 | Final Confirmation | Wrapped | [ ] |
| 8 | Auto-Detection | Dialog | [ ] |
| 9 | Decline Option | Unwrapped | [ ] |
| 10 | Command Palette | Works | [ ] |
| 11 | JS Comment Syntax | `//` | [ ] |
| 12 | SQL Comment Syntax | `--` | [ ] |
| 13 | Indentation | Preserved | [ ] |
| 14 | Settings | Pre-filled | [ ] |
| 15 | Error - No Selection | Message | [ ] |
| 16 | Error - Unsupported Lang | Message | [ ] |
| 17 | Validator Integration | PASS | [ ] |

---

## Test Configuration

**VS Code Settings** (add to settings.json):
```json
{
  "ai-annotator.authorId": "emp-1223",
  "ai-annotator.defaultTool": "GitHub Copilot"
}
```

**Location**:
- Windows: `%APPDATA%\Code\User\settings.json`
- macOS: `~/Library/Application Support/Code/User/settings.json`
- Linux: `~/.config/Code/user/settings.json`

Or set in VS Code UI:
1. File → Preferences → Settings
2. Search: `ai-annotator`
3. Set values

---

## Reporting Results

After running tests, report:
- [ ] How many tests passed
- [ ] Any failures or errors
- [ ] Unexpected behaviors
- [ ] Missing or incorrect annotations

---

**Ready to run tests!**
